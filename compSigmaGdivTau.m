function M=compSigmaGdivTau(b11,b12,b21,b22,p,q)
    dimP=(p+1)*(p+2);
    dimQ=(q+1)*(q+2);
    M = zeros(1,dimP*dimQ);
    
    if (p==0) && (q==2)
        M(1,1)=0;
        M(1,2)=0;
        M(1,3)=0;
        M(1,4)=0;
        M(1,5)=0;
        M(1,6)=0;
        M(1,7)=(b22*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,8)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,9)=-(b21*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,10)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,11)=-(b21*b22)/(b11*b22 - b12*b21)^2;
        M(1,12)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,13)=0;
        M(1,14)=0;
        M(1,15)=0;
        M(1,16)=0;
        M(1,17)=0;
        M(1,18)=0;
        M(1,19)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,20)=(b12*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,21)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,22)=-(b11*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,23)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,24)=-(b11*b12)/(b11*b22 - b12*b21)^2;
    end
    
    if (p==0) && (q==3)
        M(1,1)=0;
        M(1,2)=0;
        M(1,3)=0;
        M(1,4)=0;
        M(1,5)=0;
        M(1,6)=0;
        M(1,7)=(b22*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,8)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,9)=-(b21*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,10)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,11)=-(b21*b22)/(b11*b22 - b12*b21)^2;
        M(1,12)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,13)=(b21*(b21 - 2*b22))/(3*(b11*b22 - b12*b21)^2);
        M(1,14)=((b11*b22)/3 - b21*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,15)=(b22*(2*b21 - b22))/(3*(b11*b22 - b12*b21)^2);
        M(1,16)=-((b12*b21)/3 + b22*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,17)=-(b21^2 - b22^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,18)=(b11*b21 - b12*b22)/(3*(b11*b22 - b12*b21)^2);
        M(1,19)=-(b21^2 - b21*b22 + b22^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,20)=(b11*(b21/3 - b22/6) - b12*(b21/6 - b22/3))/(b11*b22 - b12*b21)^2;
        M(1,21)=0;
        M(1,22)=0;
        M(1,23)=0;
        M(1,24)=0;
        M(1,25)=0;
        M(1,26)=0;
        M(1,27)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,28)=(b12*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,29)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,30)=-(b11*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,31)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,32)=-(b11*b12)/(b11*b22 - b12*b21)^2;
        M(1,33)=((b11*b22)/3 - b21*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,34)=(b11*(b11 - 2*b12))/(3*(b11*b22 - b12*b21)^2);
        M(1,35)=-((b12*b21)/3 + b22*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,36)=(b12*(2*b11 - b12))/(3*(b11*b22 - b12*b21)^2);
        M(1,37)=(b11*b21 - b12*b22)/(3*(b11*b22 - b12*b21)^2);
        M(1,38)=-(b11^2 - b12^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,39)=(b11*(b21/3 - b22/6) - b12*(b21/6 - b22/3))/(b11*b22 - b12*b21)^2;
        M(1,40)=-(b11^2 - b11*b12 + b12^2)/(3*(b11*b22 - b12*b21)^2);
    end 
    
    if (p==0) && (q==4)
        M(1,1)=0;
        M(1,2)=0;
        M(1,3)=0;
        M(1,4)=0;
        M(1,5)=0;
        M(1,6)=0;
        M(1,7)=(b22*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,8)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,9)=-(b21*(b21 - b22))/(b11*b22 - b12*b21)^2;
        M(1,10)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,11)=-(b21*b22)/(b11*b22 - b12*b21)^2;
        M(1,12)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,13)=(b21*(b21 - 2*b22))/(3*(b11*b22 - b12*b21)^2);
        M(1,14)=((b11*b22)/3 - b21*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,15)=(b22*(2*b21 - b22))/(3*(b11*b22 - b12*b21)^2);
        M(1,16)=-((b12*b21)/3 + b22*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,17)=-(b21^2 - b22^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,18)=(b11*b21 - b12*b22)/(3*(b11*b22 - b12*b21)^2);
        M(1,19)=-(b21^2 - b21*b22 + b22^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,20)=(b11*(b21/3 - b22/6) - b12*(b21/6 - b22/3))/(b11*b22 - b12*b21)^2;
        M(1,21)=-(6*b21*b22 + b21^2 - 6*b22^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,22)=(b12*(b21/4 - b22/2) + b11*(b21/12 + b22/4))/(b11*b22 - b12*b21)^2;
        M(1,23)=-(6*b21*b22 - 6*b21^2 + b22^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,24)=-(b11*(b21/2 - b22/4) - b12*(b21/4 + b22/12))/(b11*b22 - b12*b21)^2;
        M(1,25)=-(b21^2 - 8*b21*b22 + b22^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,26)=(b11*(b21/12 - b22/3) - b12*(b21/3 - b22/12))/(b11*b22 - b12*b21)^2;
        M(1,27)=-(b21^2 - b22^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,28)=(b11*b21 - b12*b22)/(12*(b11*b22 - b12*b21)^2);
        M(1,29)=(b21*(b21 - 2*b22))/(12*(b11*b22 - b12*b21)^2);
        M(1,30)=((b11*b22)/12 - b21*(b11/12 - b12/12))/(b11*b22 - b12*b21)^2;
        M(1,31)=0;
        M(1,32)=0;
        M(1,33)=0;
        M(1,34)=0;
        M(1,35)=0;
        M(1,36)=0;
        M(1,37)=-(b12*b21 + b22*(b11 - 2*b12))/(2*(b11*b22 - b12*b21)^2);
        M(1,38)=(b12*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,39)=-(b12*b21 - b11*(2*b21 - b22))/(2*(b11*b22 - b12*b21)^2);
        M(1,40)=-(b11*(b11 - b12))/(b11*b22 - b12*b21)^2;
        M(1,41)=(b11*b22 + b12*b21)/(2*(b11*b22 - b12*b21)^2);
        M(1,42)=-(b11*b12)/(b11*b22 - b12*b21)^2;
        M(1,43)=((b11*b22)/3 - b21*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,44)=(b11*(b11 - 2*b12))/(3*(b11*b22 - b12*b21)^2);
        M(1,45)=-((b12*b21)/3 + b22*(b11/3 - b12/3))/(b11*b22 - b12*b21)^2;
        M(1,46)=(b12*(2*b11 - b12))/(3*(b11*b22 - b12*b21)^2);
        M(1,47)=(b11*b21 - b12*b22)/(3*(b11*b22 - b12*b21)^2);
        M(1,48)=-(b11^2 - b12^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,49)=(b11*(b21/3 - b22/6) - b12*(b21/6 - b22/3))/(b11*b22 - b12*b21)^2;
        M(1,50)=-(b11^2 - b11*b12 + b12^2)/(3*(b11*b22 - b12*b21)^2);
        M(1,51)=(b12*(b21/4 - b22/2) + b11*(b21/12 + b22/4))/(b11*b22 - b12*b21)^2;
        M(1,52)=-(6*b11*b12 + b11^2 - 6*b12^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,53)=-(b11*(b21/2 - b22/4) - b12*(b21/4 + b22/12))/(b11*b22 - b12*b21)^2;
        M(1,54)=-(6*b11*b12 - 6*b11^2 + b12^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,55)=(b11*(b21/12 - b22/3) - b12*(b21/3 - b22/12))/(b11*b22 - b12*b21)^2;
        M(1,56)=-(b11^2 - 8*b11*b12 + b12^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,57)=(b11*b21 - b12*b22)/(12*(b11*b22 - b12*b21)^2);
        M(1,58)=-(b11^2 - b12^2)/(12*(b11*b22 - b12*b21)^2);
        M(1,59)=((b11*b22)/12 - b21*(b11/12 - b12/12))/(b11*b22 - b12*b21)^2;
        M(1,60)=(b11*(b11 - 2*b12))/(12*(b11*b22 - b12*b21)^2);
    end
end